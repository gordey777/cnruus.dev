"use strict";!function(t){var e=t(document);t.expr[":"].style=function(e,o,i){var n,a,r=t(e),s=i[3].split(",");if(s=t.map(s,function(e){return t.trim(e)}),n=s[0],a=s[1],r.css(n)==a)return!0},t.s3throttle=function(e,o,i){var n=t.s3throttle.timeouts[e];n&&clearTimeout(n),t.s3throttle.timeouts[e]=setTimeout(o,i)},t.s3escape=function(e){return t("<div>").text(e).html()},t.s3throttle.timeouts={},t.fn.s3center=function(){return this.each(function(){var e=t(this),o=e.is(":visible");o||e.show(),e.css({marginLeft:-e.outerWidth()/2,marginTop:-e.outerHeight()/2}),o||e.hide()})},t.fn.s3deserializeArray=function(e){return this.each(function(){var o=t(this);t.each(e,function(){var t=o.find('[name="'+this.name+'"]');t.length&&(t.is("input[type=radio]")?t.filter('[value="'+this.value+'"]').trigger("click"):t.val(this.value).trigger("change"))})})},t.fn.caret=function(e,o){var i;if(0!==this.length&&!this.is(":hidden"))return"number"===t.type(e)?(o="number"===t.type(o)?o:e,this.each(function(){this.setSelectionRange?this.setSelectionRange(e,o):this.createTextRange&&(i=this.createTextRange(),i.collapse(!0),i.moveEnd("character",o),i.moveStart("character",e),i.select())})):(this[0].setSelectionRange?(e=this[0].selectionStart,o=this[0].selectionEnd):document.selection&&document.selection.createRange&&(i=document.selection.createRange(),e=0-i.duplicate().moveStart("character",-1e5),o=e+i.text.length),{begin:e,end:o})},t.keys={},t.KEYS={Digit:[48,57],Backspace:8,Comma:44,Point:46},t.each(t.KEYS,function(e,o){t.keys["is"+e]=function(e){return t.isArray(o)?o[0]<=e&&e<=o[1]:o===e}}),t.fn.getVal=function(){var e=[];return this.each(function(){var o=t(this).val();o=parseFloat(o),o||(o=0),e.push(o)}),e},t.fn.keyFilter=function(e,o){return o=t.extend({type:"int",def:"",callback:t.noop},o),this.each(function(){var i=t(this);i.on("keypress",e,function(e){var i,n,a,r,s,c=t(this);return!e.shiftKey&&!e.ctrlKey&&(0===e.which||(a=t.keys.isDigit(e.which),r=t.keys.isPoint(e.which)||t.keys.isComma(e.which),n=t.keys.isBackspace(e.which),!!(a||r||n)&&(("int"!==o.type||!r)&&(s=c.val().replace(/,/g,"."),i=c.caret(),c.val(s),c.caret(i.begin,i.end),(!r||s.indexOf(".")===-1)&&void 0))))}),i.on("keyup",e,function(){var e=t(this);o.callback(e)}),i.on("blur",e,function(){var e=t(this);""===e.val()&&(e.val(o.def),o.callback(e))})})},t.fn.getHeights=function(){var e=[],o=0;return this.each(function(){var i,n=t(this);n.css("min-height",0),i=n.height(),e.push(i),i>o&&(o=i)}),{values:e,max:o}},t.fn.eachRow=function(t,e){var o,i,n,a,r,s,c=this,l=c.parent(),d=0;if(l.get(0)&&c.get(0)&&(o=l.width(),i=c.outerWidth(!0),e&&(o+=parseFloat(c.css("margin-right"))),n=Math.floor(o/i),n>1))for(s=c.length;d<s;d+=n)a=d,r=d+n,r>s&&(r=s),t(c.slice(a,r),c.eq(a),c.eq(r-1));return c},t.on=function(o,i){t.each(i,function(t,i){e.on(t,o,i)})},t.fn.s3tooltip=function(o){o=t.extend({data:function(){return this.alt||""},cls:"tooltip-1",slide:!0,dir:"bottom"},o);var i=t("#shop2-tooltip");i.get(0)||(i=t('<div id="shop2-tooltip"></div>'),t("body").append(i));var n,a,r=this.selector,s={$el:t(window)};t.on(r,{mouseenter:function(t){var e=o.data.call(this);e&&(s.width=s.$el.width(),s.height=s.$el.height(),i.html(e),i.addClass(o.cls),i.show(),n=i.outerWidth(!0),a=i.outerHeight(!0))},mouseleave:function(t){i.hide(),i.removeClass(o.cls)},mousemove:function(t){var r=t.pageX,c=t.pageY,l=e.scrollTop();r+n>s.width&&(r-=n),"top"==o.dir?(c-=a,c<l&&(o.slide?c=l:c+=a)):c+a>s.height+l&&(o.slide?c=s.height+l-a:c-=a),i.css({left:r,top:c})}})}}(jQuery),function(t,e){var o={queue:{},callbacks:{},init:function(e){t.extend(this,e),this.my=this.my||{},t(function(){var e=o.queue;t.each(e,function(o){var i=e[o];t.isFunction(i)&&i()})})}};document.location.search.indexOf("debug")!=-1&&(o.debug=!0);try{if(window.sessionStorage){var i=sessionStorage.getItem("shop2_current_url"),n=location.pathname+location.search;i!=n&&sessionStorage.setItem("shop2_back_url",i),sessionStorage.setItem("shop2_current_url",n)}o.back=function(){var t;return window.sessionStorage?(t=sessionStorage.getItem("shop2_back_url"),"null"===t&&(t="/")):t=document.referrer,document.location=t||"/",!1}}catch(a){o.back=function(){document.location=document.referrer}}o.on=function(e,o){var i=this;t.each(e.split(","),function(e,n){n=t.trim(n),i.callbacks[n]||(i.callbacks[n]=t.Callbacks()),i.callbacks[n].add(o)})},o.off=function(t,e){this.callbacks[t]&&(e?this.callbacks[t].remove(e):this.callbacks[t].empty())},o.trigger=function(t){this.callbacks[t]&&this.callbacks[t].fireWith(e,[].slice.call(arguments,1))},o.fire=function(o,i){if(t.isFunction(i)){var n=!!(this.callbacks&&this.callbacks[o]&&this.callbacks[o].has(i));n||i.apply(e,[].slice.call(arguments,2))}},o.filter={_pre_params:"",init:function(){var t=decodeURIComponent(document.location.search);t&&(t=t.slice(1)),this.str=t},escape:function(t){return t.replace(/(\[|\])/g,"\\$1")},remove:function(t,e){var o=t+"=";"undefined"!=typeof e&&(o+=e);var i=new RegExp("(.*)("+this.escape(o)+"[^&]*&*)(.*)","ig");return this.str=this.str.replace(i,"$1$3").replace(/&$/,""),this},add:function(t,e){return this.remove(t,e),this.str+=""!==this.str?"&":"",this.str+=t+"="+e,this},has:function(t,e){var o=t+"=";return"undefined"!=typeof e&&(o+=e),this.str.indexOf(o)>-1},get:function(t){var e=new RegExp(this.escape(t)+"=([^&]*)"),o=this.str.match(e);return!(!o||2!=o.length)&&o[1]},toggle:function(t,e){if("s[amount][min]"==t){if("0"===this.get("s[amount][max]"))return this.remove("s[amount][max]"),this.add("s[amount][min]",0),this;if("0"===this.get("s[amount][min]"))return this.remove("s[amount][min]"),this.add("s[amount][max]",0),this}else if("s[amount][max]"==t){if("1"===this.get("s[amount][min]"))return this.remove("s[amount][min]"),this.add("s[amount][min]",0),this;if("0"===this.get("s[amount][min]"))return this.remove("s[amount][min]"),this.add("s[amount][min]",1),this}return this.has(t,e)?this.remove(t,e):this.add(t,e),this},sort:function(t){var e=new RegExp(this.escape("s[sort_by]")+"=([^&]*)"),o=this.str.match(e),i=t+" desc",n=t+" asc";return o=o&&o.length>1?o[1]:"",o.indexOf(i)!==-1?o=o.replace(i,n):o.indexOf(n)!==-1?o=o.replace(n,i):""!==o?o+=","+i:o=i,this.remove("s[sort_by]"),this.add("s[sort_by]",o),this},go:function(){var t="";return this.str&&(t+="?"==this.str.charAt(0)?"":"?",t+=this.str),document.location=document.location.pathname.replace(/\/p\/\d*/g,"")+t+document.location.hash,!1},count:function(e){var i="/my/s3/api/shop2/?cmd=getSearchMatches&hash="+o.apiHash.getSearchMatches+"&ver_id="+o.verId+"&"+this.str+this._pre_params;o.trigger("beforeGetSearchMatches"),t.get(i,function(i,n){"success"==n&&"string"===t.type(i)&&(i=t.parseJSON(i)),o.fire("afterGetSearchMatches",e,i,n),o.trigger("afterGetSearchMatches",i,n)})}},o.search={getParams:function(e,i){var n;o.trigger("beforeGetFolderCustomFields"),e>0&&(n="/my/s3/api/shop2/?cmd=getFolderCustomFields&hash="+o.apiHash.getFolderCustomFields+"&ver_id="+o.verId+"&folder_id="+e+"&"+decodeURIComponent(document.location.search).replace(/[^&]*=(&|$)/g,""),t.getJSON(n,function(t,e){o.fire("afterGetFolderCustomFields",i,t,e),o.trigger("afterGetFolderCustomFields",t,e)}))}},o.cart={add:function(e,i,n){o.trigger("beforeCartAddItem"),t.post("/my/s3/api/shop2/?cmd=cartAddItem",{hash:o.apiHash.cartAddItem,ver_id:o.verId,kind_id:e,amount:i},function(t,e){o.fire("afterCartAddItem",n,t,e),o.trigger("afterCartAddItem",t,e)},"json")},addMultiple:function(e,i){o.trigger("beforeCartAddMultipleItems"),e=t.extend({hash:o.apiHash.cartAddItem,ver_id:o.verId},e),t.post("/my/s3/api/shop2/?cmd=cartAddItem",e,function(t,e){o.fire("afterCartAddMultipleItems",i,t,e),o.trigger("afterCartAddMultipleItems",t,e)},"json")},remove:function(e,i){return e=e.toString().replace(/\"/g,'\\"').replace(/\'/g,'"'),e=t.parseJSON(e),o.trigger("beforeCartRemoveItem"),t.getJSON("/my/s3/api/shop2/?cmd=cartRemoveItem",{hash:o.apiHash.del,ver_id:o.verId,kind_id:e},function(t,e){o.fire("afterCartRemoveItem",i,t,e),o.trigger("afterCartRemoveItem",t,e)}),!1},clear:function(){o.trigger("beforeCartClear"),t.get(o.uri+"?mode=cart&action=cleanup",function(t,e){o.trigger("afterCartClear",t,e)})},update:function(e,i){var n=e.serialize();return o.trigger("beforeCartUpdate"),t.post("/my/s3/api/shop2/?cmd=cartUpdate","ver_id="+o.verId+"&hash="+o.apiHash.up+"&"+n,function(t,e){o.fire("afterCartUpdate",i,t,e),o.trigger("afterCartUpdate",t,e)}),!1},addCoupon:function(e,i){return o.trigger("beforeCartAddCoupon"),t.getJSON("/my/s3/api/shop2/?cmd=cartAddCoupon",{hash:o.apiHash.coupon_add,ver_id:o.verId,coupon:e},function(t,e){o.fire("afterCartAddCoupon",i,t,e),o.trigger("afterCartAddCoupon",t,e)}),!1},removeCoupon:function(e,i){o.trigger("beforeCartRemoveCoupon"),t.getJSON("/my/s3/api/shop2/?cmd=cartRemoveCoupon",{hash:o.apiHash.coupon_del,ver_id:o.verId,coupon:e},function(t,e){o.fire("afterCartRemoveCoupon",i,t,e),o.trigger("afterCartRemoveCoupon",t,e)})}},o.delivery={calc:function(e,i,n){o.trigger("beforeDeliveryCalc"),t.getJSON("/my/s3/api/shop2/?cmd=deliveryCalc",{hash:o.apiHash.calc,ver_id:o.verId,attach_id:e,params:i},function(t,e){o.fire("afterDeliveryCalc",n,t,e),o.trigger("afterDeliveryCalc",t,e)})}},o.compare={add:function(t,e){this.action("add",t,e)},remove:function(t,e){this.action("del",t,e)},clear:function(t){this.action("clear",null,t)},action:function(e,i,n){var a=t.camelCase("Compare-"+e);o.trigger("before"+a),t.post("/my/s3/api/shop2/?cmd=compare",{hash:o.apiHash.compare,ver_id:o.verId,kind_id:i,action:e},function(t,e){o.fire("after"+a,n,t,e),o.trigger("after"+a,t,e)})}},o.product={getProductListItem:function(e,i,n){var a="/my/s3/api/shop2/?cmd=getProductListItem&hash="+o.apiHash.getProductListItem+"&ver_id="+o.verId;o.trigger("beforeGetProductListItem"),t.post(a,{product_id:e,kind_id:i},function(t,e){o.fire("afterGetProductListItem",n,t,e),o.trigger("afterGetProductListItem",t,e)})},checkMetaItemValue:function(t,e,o){var i=t[e];if("undefined"==i||null==i)return!1;if(i==o)return!0;if(i instanceof Object)for(var n in i)if(i[n]==o)return!0;return!1},getMetaItemValue:function(e,o){var i=e[o];if("undefined"===t.type(i))return!1;if("object"===t.type(i)){if("undefined"!==t.type(i.v))return i.v;if("undefined"!==t.type(i.image_id))return i.image_id}return i},findKindId:function(e,i,n,a,r,s){var c,l,d,u,p,h=0,f=t.extend(!0,{},o.productRefs[e]);if(s&&t.each(f,function(t){s[t]||delete f[t]}),1==i.length)return i[0];for("object"!==t.type(r)&&(r=t.parseJSON(r)),c=0,l=i.length;c<l;c+=1)d=Number(i[c]),p=0,t.each(f,function(e,i){t.each(i,function(t){if(e==n)t==a&&(p+=1);else{if(String(f[e][t]).indexOf(d)===-1)return;p+=1,r&&o.product.checkMetaItemValue(r,e,t)&&(p+=1)}})}),p>h&&(u=d,h=p);return u},getNodeData:function(e,o,i){var n=!1;return"SELECT"==e.tagName?n=t(e.options[e.selectedIndex]).data(o):1==e.nodeType&&(n=t(e).data(o)),i&&(n=this.decodeFieldData(n)),n},decodeFieldData:function(e){return"string"!==t.type(e)?[e]:(e=e.split(","),t.map(e,function(e){return t.trim(e)}))},hasKindId:function(t,e){var o,i;if(t)for(o=0,i=e.length;o<i;o+=1)if(t.indexOf(e[o])!==-1)return!0;return!1}},o.options={amountDefaultValue:1,amountDefaultInc:1,amountType:"int",msgTime:1500,printCSS:"/g/shop2v2/default/css/print.less.css"},o.msg=function(e,i){var n="#shop2-msg",a=t(n),r=i.offset(),s=i.outerWidth(!0),c=i.outerHeight(!0);a.get(0)||(a=t('<div id="shop2-msg">'),t(document.body).append(a),a=t(n)),a.html(e).show();var l=a.outerWidth(),d=r.left+s,u=r.top+c;d+l>t(window).width()&&(d=r.left-l),a.css({left:d,top:u}),t.s3throttle("msg",function(){a.hide()},o.options.msgTime)},o.queue={cookiesDisabled:function(){navigator&&0==navigator.cookieEnabled&&t(".shop2-cookies-disabled").html("<p>Внимание! Для корректной работы у Вас в браузере должна быть включена поддержка cookie. В случае если по каким-либо техническим причинам передача и хранение cookie у Вас не поддерживается оформление заказа невозможно.</p>").removeClass("hide")},cartState:function(){function e(){return t("<div>").append(t("#shop2-cart-preview").clone()).html()}function i(e){e&&t("#shop2-cart-preview").replaceWith(e)}try{window.sessionStorage}catch(n){return}window.chrome&&sessionStorage&&o.my.save_cart_state&&(readCookie("s3s2_cart")||(sessionStorage.removeItem("cart-reload"),sessionStorage.removeItem("cart-state")),1==sessionStorage.getItem("cart-reload")&&(sessionStorage.removeItem("cart-reload"),sessionStorage.setItem("cart-state",e())),o.on("afterCartAddItem",function(t,e){var o=t.data;"success"!=e&&(o=""),sessionStorage.setItem("cart-state",o)}),o.on("afterCartRemoveItem, afterCartUpdate",function(){sessionStorage.setItem("cart-reload",1)}),t(window).on("pageshow",function(){i(sessionStorage.getItem("cart-state"))}))},keys:function(){t(document).keyFilter("input.shop2-input-int"),t(document).keyFilter("input.shop2-input-float",{type:"float"})},heights:function(){t(".product-list-thumbs").each(function(){var e=t(this);e.find(".product-item-thumb").eachRow(function(e){var o,i,n=e.find(".product-name");n.css("min-height",0),i=n.getHeights(),n.css("min-height",i.max);var a=e.find(".product-amount");a.length?(a.css("margin-top",0),o=e.getHeights(),e.each(function(e){t(this).find(".product-amount").css("margin-top",o.max-o.values[e])})):(e.each(function(){var e=t(this),o=e.find(".shop2-product-actions");o.length||(o=e.find(".product-bot"));var i=o.data("padding-top");"undefined"===t.type(i)&&(i=parseInt(e.css("padding-top")),o.data("padding-top",i)),o.css("padding-top",i)}),o=e.getHeights(),e.each(function(e){var i=t(this),n=i.find(".shop2-product-actions");n.length||(n=i.find(".product-bot"));var a=n.data("padding-top");n.css("padding-top",o.max-o.values[e]+a)}))})})},resize:function(){t(window).resize(function(){o.queue.heights()})},product:function(){o.product._reload=function(e){var i,n,a,r=t(e),s=o.product.getNodeData(e,"kinds",!0),c=o.product.getNodeData(e,"name"),l=o.product.getNodeData(e,"value"),d=r.closest("form"),u=d.get(0),p={};s&&"undefined"!==t.type(c)&&"undefined"!==t.type(l)&&u&&(i=d.find("input[name=meta]").val(),a=d.find("input[name=product_id]").val(),d.find("[name=submit]").prop("disabled",!0),d.find("select.shop2-cf>option, li.shop2-cf, li.shop2-color-ext-selected, ul.shop2-color-ext-list>li").each(function(){var e=t(this).data("name");e&&(p[e]=!0)}),n=o.product.findKindId(a,s,c,l,i,p),"product"==o.mode?o.uri?document.location=o.uri+"/product/"+n:document.location=document.location.href.replace(/\/product\/.+/,"/product/"+n):o.product.getProductListItem(a,n,function(e,i){var n,a,s;"success"===i&&(n=r.closest(".shop2-product-item"),n.hide(),s=t.trim(e.data.body),a=t(s).insertBefore(n),n.remove(),o.queue.heights())}))},t.on("select.shop2-cf",{change:function(){o.product._reload(this)}}),t.on("li.shop2-cf:not(.active-color, .active-texture)",{click:function(){o.product._reload(this)}})},addToCart:function(){t(document).on("click",".shop2-product-btn",function(e){var i,n,a=t(this),r=a.closest("form"),s=r.get(0),c=r.find(".additional-cart-params"),l=c.length,d=s.amount.value,u=s.kind_id.value;if(e.preventDefault(),l)for(d={amount:d},i=0;i<l;i+=1)n=c[i],n.value&&(d[n.name]=n.value);o.cart.add(u,d,function(e){t("#shop2-cart-preview").replaceWith(e.data),e.errstr?o.msg(e.errstr,a):o.msg(window._s3Lang.JS_ADDED,a),e.panel&&t("#shop2-panel").replaceWith(e.panel)})})},amount:function(){function e(e){var i,n=e.data("kind"),a=e.data("max"),r=Number(e.val()),s=0;n&&a>0&&(t("input[data-kind="+n+"]").each(function(){s+=Number(this.value)}),s>a&&(i=a-s+r,e.val(i),o.msg(_s3Lang.JS_AVAILABLE_ONLY+" "+i,e)))}var i=t(document);i.on("click",".amount-minus",function(){var e=t(this),i=e.siblings("input:text"),n=i.getVal();n&&(n=n[0]),n-=o.options.amountDefaultInc,n=n.toFixed(5)-0,n<=o.options.amountDefaultValue&&(n=o.options.amountDefaultValue),i.val(n),i.trigger("keyup")}),i.on("click",".amount-plus",function(){var e=t(this),i=e.siblings("input:text"),n=i.getVal();n&&(n=n[0]),n+=o.options.amountDefaultInc,n=n.toFixed(5)-0,i.val(n),i.trigger("keyup")}),i.on("keyup",".shop2-product-amount input:text",function(){var o=t(this);e(o)}),i.keyFilter(".shop2-product-amount input:text",{type:o.options.amountType})},discounts:function(){t(document).on("click",".shop2-product-actions dt",function(e){var o=t(this),i=o.next(),n=o.position().left;e.stopPropagation(),i.is(":hidden")?(t(".shop2-product-actions dd").hide(),i.show(),i.css("left",n)):i.hide()}),t(document).on("click",".close-desc-action",function(e){var o=t(this),i=o.closest("dd");e.stopPropagation(),i.hide()}),t(document).on("click",function(){t(".shop2-product-actions dd").hide()})},question:function(){var e=".price-old.question, .shop2-cart-total .question";t(document).on("mouseenter",e,function(){var e=t(this),o=e.next().show(),i=e.position(),n=o.outerHeight(!0);o.css({top:i.top-n-5,left:i.left})}).on("mouseleave",e,function(){var e=t(this),o=e.next();o.hide()})},tabs:function(){var e=t(".shop2-product-tabs li"),o=e.find("a"),i=t(".shop2-product-desc > div");o.on("click",function(o){var n=t(this),a=n.attr("href");o.preventDefault(),e.removeClass("active-tab"),n.parent().addClass("active-tab"),i.removeClass("active-area"),t(a).addClass("active-area")})},filter:function(){var e=t(".shop2-filter"),i=t(".result");o.filter.init(),o.on("afterGetSearchMatches",function(e,o){0===e.data.total_found?i.addClass("no-result"):i.removeClass("no-result"),t("#filter-result").html(e.data.total_found),i.removeClass("hide")}),e.find(".param-val").on("click",function(e){var i=t(this),n=i.data("name"),a=i.data("value");e.preventDefault(),i.toggleClass("active-val"),o.filter.toggle(n,a),o.filter.count()}),e.find("select").on("change",function(){var e=t(this),i=this.name,n=e.val();o.filter.add(i,n),o.filter.count()}),e.find("input:text").keyup(function(){var e=t(this),i=e.attr("name");t.s3throttle("filter: "+i,function(){var t=e.val();o.filter.add(i,t),o.filter.count()},500)}),e.find(".shop2-filter-go").on("click",function(t){t.preventDefault(),o.filter.go()})},sort:function(){var e=t(".sorting");e.find(".sort-param").on("click",function(e){var i=t(this),n=i.data("name");e.preventDefault(),o.filter.sort(n),o.filter.go()}),e.find(".sort-reset").on("click",function(t){t.preventDefault(),o.filter.remove("s[sort_by]"),o.filter.go()})},views:function(){t(".view-shop a").on("click",function(e){var i=t(this),n=i.data("value");e.preventDefault(),o.filter.remove("view"),o.filter.add("view",n),o.filter.go()})},toggle:function(){function e(e,o,i,n){t(document).on("click",o+" "+e,function(e){var a=t(o);e.preventDefault(),a.hasClass(i)?(a.removeClass(i),eraseCookie(n)):(a.addClass(i),createCookie(n,1,7))})}e(".block-title",".cart-preview","opened","cart_opened"),e(".block-title",".search-form","opened","search_opened"),e(".block-title",".login-form ","opened","login_opened")},search:function(){var e=t("#shop2_search_custom_fields"),i=t("#shop2_search_global_fields");o.on("afterGetFolderCustomFields",function(t,o){e.html(t.data),i.find("input, select").prop("disabled",!0),i.hide()}),t("#s\\[folder_id\\]").on("change",function(){var n=t(this),a=n.val();a?o.search.getParams(a):(e.html(""),i.find("input, select").prop("disabled",!1),i.show())}).trigger("change")},cart:function(){function e(){i.show()}var i=t(".shop2-cart-update"),n=t(".shop2-cart-table"),a=t("#shop2-cart");o.on("afterCartRemoveItem, afterCartUpdate",function(){document.location.reload()}),n.find("input:text").on("keypress",function(t){13==t.keyCode?o.cart.update(a):e()}),n.find(".amount-minus, .amount-plus").on("click",e),i.on("click",function(t){return t.preventDefault(),o.cart.update(a),!1}),t(".cart-delete a").on("click",function(e){var i=t(this),n=i.data("id");e.preventDefault(),o.cart.remove(n)})},coupon:function(){o.on("afterCartAddCoupon, afterCartRemoveCoupon",function(){document.location.reload()}),t(".coupon-btn").on("click",function(e){var i=t("#coupon"),n=i.val();e.preventDefault(),n&&o.cart.addCoupon(n)}),t(".coupon-delete").on("click",function(e){var i=t(this),n=i.data("code");e.preventDefault(),n&&o.cart.removeCoupon(n)})},delivery:function(){var e=t(".option-label"),i=t(".option-type"),n=e.next();e.on("click",function(){var e=t(this),o=e.parent().index();i.removeClass("active-type").eq(o).addClass("active-type"),n.find("input, textarea, select").prop("disabled",!0),e.next().find("input, textarea, select").prop("disabled",!1)}),t("#shop2-ems-calc, #shop2-edost-calc").on("click",function(e){var i=t(this),n=i.data("attach-id"),a=t("select[name="+n+"\\[to\\]]"),r=t("input[name="+n+"\\[zip\\]]");0==a.length&&(a=t("#shop2-edost2-to")),e.preventDefault(),a=a.get(0)?a.val():"",r=r.get(0)?r.val():"",o.delivery.calc(n,"to="+a+"&zip="+r,function(e){!e.data&&e.errstr?(o.alert(e.errstr),t("#delivery-"+n+"-cost").html(0)):(t("#delivery-"+n+"-cost").html(e.data.cost),e.data.html&&(t("#delivery-"+n+"-html").html(e.data.html),o.queue.edost()))})})},edost:function(){function e(e){var o="[name="+e.replace(/([\[\]])/g,"\\$1")+"]";return t(o)}function o(e){var o=t.trim(e.text()).replace(/\s*\n\s*/g,"\n").split("\n").splice(1).join("\n");a.val(o).prop("readonly",!0)}var i=t("#shop2-edost-calc"),n=i.data("attach-id"),a=e(n+"[address]");e(n+"[edost][office]").on("click",function(){var e=t(this),i=e.closest(".shop2-edost-office");o(i),e.prop("checked",!0)}),e(n+"[edost][tarif]").on("click",function(){var e,i=t(this),n=i.closest(".shop2-edost-variant"),r=n.siblings(),s=n.find(".shop2-edost-office");r.find(".shop2-edost-office input, .shop2-edost-pickpointmap input").prop({disabled:!0,checked:!1});var c=n.find(".shop2-edost-office input, .shop2-edost-pickpointmap input").prop({disabled:!1}).filter(":radio");e=c.filter(":checked"),c.get(0)?e.get(0)?e.trigger("click"):c.eq(0).trigger("click"):1==s.length?o(s):a.prop("readonly")&&a.prop("readonly",!1).val("")}).filter(":checked").trigger("click"),t(".shop2-edost-pickpointmap a").on("click",function(){function e(e){var n={};t.each(["name","address","id"],function(t,o){n[o]=e[o]}),o.next().val(JSON.stringify(n)),i.html(": "+n.name),a.val(n.name+",\n"+n.address).prop("readonly",!0)}var o=t(this),i=o.children(),n=o.data("city");return o.closest(".shop2-edost-variant").find("> label input").trigger("click"),PickPoint.open(e,{city:n,ids:null}),!1})},edost2:function(){function e(e){var o=t.map(e,function(t){return'<option value="'+t.id+'">'+t.name+"</option>"});return o.join("")}function o(t){t.html("").closest(".option-item").addClass("hide")}function i(t){t.closest(".option-item").removeClass("hide")}if(window.shop2EdostRegions){var n,a=t("#shop2-edost2-country"),r=a.html(),s=t("#shop2-edost2-region"),c=s.html(),l=t("#shop2-edost2-city"),d=l.html(),u=t("#shop2-edost2-to");a.length&&(n=t.grep(shop2EdostRegions,function(t){return t.is_country}),a.html(r+e(n)),o(s),o(l),a.on("change",function(){var a=t(this).val();s.length?(n=t.grep(shop2EdostRegions,function(t){return t.is_region&&t.country==a}),s.html(c+e(n)),0==n.length?(o(s),o(l),u.val(a)):(i(s),u.val(""))):l.length?(n=t.grep(shop2EdostRegions,function(t){return t.is_city&&t.country==a}),l.html(d+e(n)),0==n.length?(o(l),u.val(a)):(i(l),u.val(""))):u.val(a)})),s.length&&(a.length||(n=t.grep(shop2EdostRegions,function(t){return t.is_region}),s.html(c+e(n)),o(l)),s.on("change",function(){var a=t(this).val();n=t.grep(shop2EdostRegions,function(t){return t.is_city&&t.region==a}),l.html(d+e(n)),0==n.length?(o(l),u.val(a)):(i(l),u.val(""))})),a.length||s.length||(n=t.grep(shop2EdostRegions,function(t){return t.is_city}),l.html(c+e(n))),l.on("change",function(){var e=t(this).val();e&&u.val(e)});var p=a.data("value"),h=s.data("value"),f=l.data("value");p&&a.val(p),a.trigger("change"),h&&s.val(h),s.trigger("change"),f&&l.val(f),l.trigger("change")}},print:function(){t("#order-print").on("click",function(){return s3.printMe("shop2-order",{stylesheet:o.options.printCSS}),!1})},hs:function(){t(".shop2-compare-product-image a img, .shop2-compare-data a img, .shop2-product .product-image a img, .shop2-product .product-thumbnails li a img, .cart-product-image a img, .cart-product-param a img").closest("a").on("click",function(){return hs.expand(this),!1}).addClass("highslide"),t(document).on("click",".shop2-edost-office-address a",function(){return hs.htmlExpand(this,{objectType:"iframe",wrapperClassName:"draggable-header",outlineType:"rounded-white",width:900,height:600,align:"center"}),!1})},vendors:function(){t(".shop2-vendor").eachRow(function(e){var o=e.getHeights();e.each(function(e){var i=t(this),n=o.max-o.values[e],a=i.find(".vendor-name"),r=a.height();a.css("min-height",r+n)})})},toggleFields:function(){var e=t(".shop2-filter-fields"),o="filter_opened",i=readCookie(o),n=t(".shop2-toggle-fields");n.on("click",function(){var i=t(this),n=i.data("alt"),a=i.html();return e.hasClass("hide")?createCookie(o,1,7):eraseCookie(o),e.toggleClass("hide"),i.html(n),i.data("alt",a),!1}),i||n.trigger("click")},lazyLoad:function(){function e(t,e,o){return t+(~t.indexOf("?")?"&":"?")+e+"="+o}var i=t(document),n=t(window),a=!1,r=t(".product-list");o.my.lazy_load_subpages&&r.get(0)&&i.scroll(function(){var r=t(".shop2-pagelist:last"),s=r.find(".active-num").next().find("a");r.addClass("show");var c=r.offset().top;r.removeClass("show"),i.scrollTop()+n.height()>=c&&!a&&s.get(0)&&(a=!0,t.get(e(s.attr("href"),"products_only",1),function(e){r.after("<hr />"+e),r=t(".shop2-pagelist:last"),r.find("a").each(function(){var e=t(this),o=e.attr("href");e.attr("href",o.replace(/[&|\?]*products_only=[^&]/,""))}),o.queue.heights(),a=!1}))})},compare:function(){function e(e,o){t("input[type=checkbox][value="+e.val()+"]").closest(".product-compare").replaceWith(o.data),t(".product-compare-added a span").html("("+o.count+")"),o.panel&&t("#shop2-panel").replaceWith(o.panel)}var i=t(document);i.on("click",".product-compare input:checkbox",function(){var i=t(this),n=i.attr("checked")?"del":"add";o.compare.action(n,i.val(),function(t,n){"success"==n&&(t.errstr?(o.alert(t.errstr),i.prop("checked",!1)):e(i,t))})})},compareTable:function(){t(".shop2-compare-table").each(function(){function e(t){var e=t.find("td"),o=e.eq(1).html(),i=!1,n=2,a=e.length;if(a<=2)return!1;for(;n<a;n+=1){if(o!=e.eq(n).html()){i=!0;break}o=e.eq(n).html()}return i}var i=t(this),n=i.find(".shop2-compare-switch a"),a=i.find(".shop2-compare-data");i.find(".shop2-compare-delete").on("click",function(){var e=t(this),i=e.data().id;return o.compare.remove(i,function(){document.location.reload()}),!1}),n.on("click",function(){var o=t(this);return n.removeClass("shop2-compare-switch-active"),o.addClass("shop2-compare-switch-active"),0===o.index()?a.show():a.each(function(){var o=t(this),i=e(o);i?o.show():o.hide()}),!1}).eq(1).trigger("click")})},alert:function(){function e(){return a.hide(),n.hide(),n.removeAttr("class"),c="",o.trigger("alertHide",n),!1}function i(){a.show(),n.attr("class",c),n.show().s3center(),o.trigger("alertShow",n)}var n,a,r,s,c,l=['<div id="shop2-alert">','<div id="shop2-alert-body"></div>','<a href="#" id="shop2-alert-ok" class="shop2-btn"></a>',"</div>",'<div id="shop2-alert-overlay"></div>'].join("\n");t(document.body).append(l),n=t("#shop2-alert"),a=t("#shop2-alert-overlay"),r=t("#shop2-alert-body"),s=t("#shop2-alert-ok"),a.on("click",e),s.on("click",e),o.alert=function(t,e,o){s.html(e||"Ok"),r.html(t),c=o||"shop2-alert--warning",i()},o.alert.hide=e},tooltip:function(){t(".shop2-tooltip").s3tooltip({cls:"shop2-color-ext-tooltip",dir:"top",data:function(){return t(this).data("tooltip")}})},colorTooltip:function(){t(".shop2-color-ext-list li").s3tooltip({cls:"shop2-color-ext-tooltip",dir:"top",data:function(){return t(this).children("div").html()}}),t(".shop2-color-ext-multi").s3tooltip({cls:"shop2-color-ext-tooltip",dir:"top",data:function(){var t=this.getElementsByTagName("ul");if(t.length)return t[0].outerHTML}})},colorPopup:function(){var e=t('<div id="shop2-color-ext-popup"></div>'),i=t('<div id="shop2-color-ext-close"></div>'),n=t('<ul id="shop2-color-ext-list" class="shop2-color-ext-list"></ul>'),a=null;e.append(i),e.append(n),t(document.body).append(e),t.on(".shop2-color-ext-caption",{click:function(){var o=t(this),i=o.closest(".shop2-color-ext-popup"),r=i.find(".shop2-color-ext-list"),s=o.offset();return a=r.children("li"),n.html(r.html()),e.css(s).show(),!1}}),t(document).on("click",".shop2-color-ext-list li",function(){var e=t(this),i=e.data(),n=e.parent().find("input.additional-cart-params"),r=e.is(".shop2-color-ext-selected");if("undefined"!=typeof i.kinds||n.length)e.addClass("shop2-color-ext-selected").siblings().removeClass("shop2-color-ext-selected"),n.length?n.val(i.value):r||o.product._reload(this);else{var s=e.index(),c=!!e.closest("#shop2-color-ext-popup").length;c&&(e.toggleClass("shop2-color-ext-selected"),a.eq(s).toggleClass("shop2-color-ext-selected"),o.filter.toggle(i.name,i.value),o.filter.count())}}),t(document).on("click",function(o){var n=t(o.target),a=n.closest("#shop2-color-ext-popup");a.get(0)&&o.target!=i.get(0)||e.hide()})},colorSelect:function(){function e(){if(i.is(":visible"))return i.hide(),!0}var i=t('<div id="shop2-color-ext-select"><ins></ins></div>'),n=null,a=null;t(document.body).append(i),t(document).on("click",e),t.on(".shop2-color-ext-select",{click:function(){if(!e()){var o=t(this),r=o.find(".shop2-color-ext-options"),s=o.offset(),c='<div class="baron-wrapper">\t<div class="baron-scroller">\t\t<div class="baron-container">\t\t\t<div class="shop2-color-ext-options">'+r.html()+'\t\t\t</div>\t\t</div>\t\t<div class="baron-scroller-bar"></div>\t</div></div>';n=r.children("li"),a=o.find("input"),i.html(c),i.show();var l=o.width(),d=i.data("width")||function(){var t=i.width();return i.data("width",t),t}();return l>d?i.css("width",l):i.css("width",d),baron(i,{scroller:".baron-scroller",container:".baron-container",bar:".baron-scroller-bar"}),i.css(s),!1}}}),t.on("#shop2-color-ext-select li:not(.shop2-color-ext-selected)",{click:function(){var e=t(this),i=e.index(),r=e.data();e.addClass("shop2-color-ext-selected").siblings().removeClass("shop2-color-ext-selected"),n.removeClass("shop2-color-ext-selected"),n.eq(i).addClass("shop2-color-ext-selected"),r.kinds?o.product._reload(n.get(i)):a.val(r.value)}})},coordinates:function(){t(document).on("click",".shop2-map-link",function(e){e.preventDefault();var i=t(this),n=i.data(),a=n.map;a.title||(a.title=i.text()),o.maps.alert(n.mapType,a)})},fixDoubleOrders:function(){var e=t(".shop2-order-form, .shop2-order-in-one-page-form"),o=e.find("[type=submit]");e.on("submit",function(){o.prop("disabled",!0),setTimeout(function(){o.prop("disabled",!1)},1e3)})},paymentMethods:function(){var e=t(".shop2-payment-type input"),o=t(".shop2-payment-methods input");e.on("change",function(){var e=t(this),i=e.closest(".shop2-payment-type").next(".shop2-payment-methods").find("input:first");o.prop("checked",!1),i.prop("checked",!0)}),o.on("change",function(){var o=t(this),i=o.closest(".shop2-payment-methods").prev(".shop2-payment-type").find("input:first");e.prop("checked",!1),i.prop("checked",!0)})},auth:function(){t(document).on("click",".js-shop2-cart-auth__expand",function(e){e.preventDefault(),t(".js-shop2-cart-auth__form").toggle()})}};var r=o.maps={};r.alert=function(t,e){o.alert('<div id="shop2-alert-map"></div>',"Закрыть","shop2-alert--map"),r[t].ready(function(){r[t].draw("shop2-alert-map",e)})},r.getCenter=function(e){var o=0,i=0;t.each(e,function(){o+=this.x,i+=this.y})},r.yandex={ymaps:window.ymaps,_loading:t.Deferred(),_loading_init:!1,_loading_callback:function(t){this.ymaps=t,this._loading.resolve(t)},ready:function(e){return this._loading.done(e),this.ymaps?void this._loading.resolve(this.ymaps):void(this._loading_init||(t("head").append('<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&onload=shop2.maps.yandex._loading_callback" type="text/javascript">'),this._loading_init=!0))},draw:function(o,i){i=t.extend({},i),i.title=t.s3escape(i.title),i.text=t.s3escape(i.text);var n=new this.ymaps.Map(o,{zoom:i.z,center:[i.x,i.y],behaviors:["drag","rightMouseButtonMagnifier","scrollZoom"]
}),a=this.ymaps.templateLayoutFactory.createClass('<div class="shop2-map-baloon-content"><h3>$[properties.title]</h3>$[properties.text]</div>'),r=new e.ymaps.Placemark([i.x,i.y],i,{balloonContentLayout:a});n.geoObjects.add(r)}},r.google={gmaps:!(!window.google||!window.google.maps)&&window.google.maps,_loading:t.Deferred(),_loading_init:!1,_loading_callback:function(){try{this.gmaps=window.google.maps,this._loading.resolve(this.gmaps)}catch(t){console.log(t)}},ready:function(e){return this._loading.done(e),this.gmaps?void this._loading.resolve(this.gmaps):void(this._loading_init||(t("head").append('<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&callback=shop2.maps.google._loading_callback" type="text/javascript">'),this._loading_init=!0))},draw:function(e,o){var i=new this.gmaps.Map(document.getElementById(e),{zoom:Number(o.z),center:new google.maps.LatLng(o.x,o.y)}),n=new google.maps.Marker({position:new google.maps.LatLng(o.x,o.y),map:i,title:o.title}),a=new google.maps.InfoWindow({content:'<div class="shop2-map-baloon-content"><h3>'+t.s3escape(o.title)+"</h3>"+t.s3escape(o.text)+"</div>"});this.gmaps.event.addListener(n,"click",function(){a.open(i,n)})}},t(window).on("load",function(){o.queue.heights()}),e.shop2=o}(jQuery,window);
//# sourceMappingURL=maps/shop2.2.js.map
